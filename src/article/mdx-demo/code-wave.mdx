import CodeWave from '../../waves/code-wave.jsx'

<CodeWave>

```js
const babel = require('@babel/core');
const React = require('react');
const { renderToStaticMarkup } = require('react-dom/server');
const mdx = require('@mdx-js/mdx');
const { MDXProvider } = require('@mdx-js/react');

async function mdxToHtml(
  mdxCode, 
  { mdxOptions, babelOptions, components }) {

}
```

Lorem markdownum seniles. Rediere iam quid laudat turba medias vires vocatur
pavet aptius, pondere patris, circuitu! Vias sumpsisse.

- Certamine at sidereum inmissusque magis tyranni ulla
- Poterat solitumque sunt
- Superbum genibusque mediis
- Pocula infans et in satis

Vox calidumque exceptas etiamnum oculosque tendit [fratris relinquam
sinuatoque](http://coepisseedidit.net/spectabere) pedibus; non. Perdidit iniquis
belua animoque carcere, per saltu non, mota rore. Venit _iubet tenuissimus_,
ille posuisti iuppiter, iam quam tradere. Sibyllae trepidare aequore terrae.
Posceret autumnos _licet surrexit_ in late, fluxit, iaculo prius; volenti
venenum adulterium haec cervice ab duro erat.

```js
const babel = require('@babel/core');
const React = require('react');
const { renderToStaticMarkup } = require('react-dom/server');
const mdx = require('@mdx-js/mdx');
const { MDXProvider } = require('@mdx-js/react');

async function mdxToHtml(
  mdxCode, 
  { mdxOptions, babelOptions, components }) {

  // mdx -> jsx
  const jsxCode = await mdx(mdxCode, mdxOptions);

  // jsx -> js
  const { code } = await babel.transformAsync(
    "import { mdx } from '@mdx-js/react';\n" + jsxCode, 
    babelOptions);

  // run the js code -> react component
  const layoutComponent = getDefaultExportFromModule(code, require);

  // component -> element
  const elementWithProvider = React.createElement(
    MDXProvider,
    { components },
    React.createElement(layoutComponent));

  // element -> html string
  return renderToStaticMarkup(elementWithProvider);
}
```

Lorem markdownum seniles. Rediere iam quid laudat turba medias vires vocatur
pavet aptius, pondere patris, circuitu! Vias sumpsisse.

- Certamine at sidereum inmissusque magis tyranni ulla
- Poterat solitumque sunt
- Superbum genibusque mediis
- Pocula infans et in satis

Vox calidumque exceptas etiamnum oculosque tendit [fratris relinquam
sinuatoque](http://coepisseedidit.net/spectabere) pedibus; non. Perdidit iniquis
belua animoque carcere, per saltu non, mota rore. Venit _iubet tenuissimus_,
ille posuisti iuppiter, iam quam tradere. Sibyllae trepidare aequore terrae.
Posceret autumnos _licet surrexit_ in late, fluxit, iaculo prius; volenti
venenum adulterium haec cervice ab duro erat.

```js
const babel = require('@babel/core');
const React = require('react');
const { renderToStaticMarkup } = require('react-dom/server');
const mdx = require('@mdx-js/mdx');
const { MDXProvider } = require('@mdx-js/react');

async function mdxToHtml(
  mdxCode, 
  { mdxOptions, babelOptions, components }) {

  // mdx -> jsx
  const jsxCode = await mdx(mdxCode, mdxOptions);

  // jsx -> js
  const { code } = await babel.transformAsync(
    "import { mdx } from '@mdx-js/react';\n" + jsxCode, 
    babelOptions);

  // run the js code -> react component
  const layoutComponent = getDefaultExportFromModule(code, require);

  // component -> element
  const elementWithProvider = React.createElement(
    MDXProvider,
    { components },
    React.createElement(layoutComponent));

  // element -> html string
  return renderToStaticMarkup(elementWithProvider);
}

function getDefaultExportFromModule(code, require) {
  const exports = {};
  new Function('require', 'exports', code)(require, exports);
  return exports['default'];
}
```

Lorem markdownum seniles. Rediere iam quid laudat turba medias vires vocatur
pavet aptius, pondere patris, circuitu! Vias sumpsisse.

- Certamine at sidereum inmissusque magis tyranni ulla
- Poterat solitumque sunt
- Superbum genibusque mediis
- Pocula infans et in satis

Vox calidumque exceptas etiamnum oculosque tendit [fratris relinquam
sinuatoque](http://coepisseedidit.net/spectabere) pedibus; non. Perdidit iniquis
belua animoque carcere, per saltu non, mota rore. Venit _iubet tenuissimus_,
ille posuisti iuppiter, iam quam tradere. Sibyllae trepidare aequore terrae.
Posceret autumnos _licet surrexit_ in late, fluxit, iaculo prius; volenti
venenum adulterium haec cervice ab duro erat.

```js
const babel = require('@babel/core');
const React = require('react');
const { renderToStaticMarkup } = require('react-dom/server');
const mdx = require('@mdx-js/mdx');
const { MDXProvider } = require('@mdx-js/react');
const { createRequire } = require('module');

async function mdxToHtml(mdxCode, path, { mdxOptions, babelOptions, components }) {

  // mdx -> jsx
  const jsxCode = await mdx(mdxCode, mdxOptions);

  // jsx -> js
  const { code } = await babel.transformAsync(
    "import { mdx } from '@mdx-js/react';\n" + jsxCode, 
    babelOptions);

  // run the js code -> react component
  const require = createRequire(path);
  const layoutComponent = getDefaultExportFromModule(code, require);

  // component -> element
  const elementWithProvider = React.createElement(
    MDXProvider,
    { components },
    React.createElement(layoutComponent));

  // element -> html string
  return renderToStaticMarkup(elementWithProvider);
}

function getDefaultExportFromModule(code, require) {
  const exports = {};
  new Function('require', 'exports', code)(require, exports);
  return exports['default'];
}
```

Lorem markdownum seniles. Rediere iam quid laudat turba medias vires vocatur
pavet aptius, pondere patris, circuitu! Vias sumpsisse.

- Certamine at sidereum inmissusque magis tyranni ulla
- Poterat solitumque sunt
- Superbum genibusque mediis
- Pocula infans et in satis

Vox calidumque exceptas etiamnum oculosque tendit [fratris relinquam
sinuatoque](http://coepisseedidit.net/spectabere) pedibus; non. Perdidit iniquis
belua animoque carcere, per saltu non, mota rore. Venit _iubet tenuissimus_,
ille posuisti iuppiter, iam quam tradere. Sibyllae trepidare aequore terrae.
Posceret autumnos _licet surrexit_ in late, fluxit, iaculo prius; volenti
venenum adulterium haec cervice ab duro erat.


```js
const babel = require('@babel/core');
const React = require('react');
const { renderToStaticMarkup } = require('react-dom/server');
const mdx = require('@mdx-js/mdx');
const { MDXProvider } = require('@mdx-js/react');
const { createRequire } = require('module');

async function mdxToHtml(mdxCode, path, { mdxOptions, babelOptions, components }) {

  // mdx -> jsx
  const jsxCode = await mdx(mdxCode, mdxOptions);

  // jsx -> js
  const { code } = await babel.transformAsync(
    "import { mdx } from '@mdx-js/react';\n" + jsxCode, 
    babelOptions);

  // run the js code -> react component
  const require = createTranspilingRequire(path, babelOptions);
  const layoutComponent = getDefaultExportFromModule(code, require);

  // component -> element
  const elementWithProvider = React.createElement(
    MDXProvider,
    { components },
    React.createElement(layoutComponent));

  // element -> html string
  return renderToStaticMarkup(elementWithProvider);
}

function createTranspilingRequire(path, babelOptions) {
  const require = createRequire(path);

  require.extensions['.jsx'] = (module, filename) => {
    const jsxCode = fs.readFileSync(filename, 'utf8');
    const { code } = babel.transformSync(jsxCode, babelOptions);
    module._compile(code, filename);
  };

  return require;
}

function getDefaultExportFromModule(code, require) {
  const exports = {};
  new Function('require', 'exports', code)(require, exports);
  return exports['default'];
}
```

Lorem markdownum seniles. Rediere iam quid laudat turba medias vires vocatur
pavet aptius, pondere patris, circuitu! Vias sumpsisse.

- Certamine at sidereum inmissusque magis tyranni ulla
- Poterat solitumque sunt
- Superbum genibusque mediis
- Pocula infans et in satis

Vox calidumque exceptas etiamnum oculosque tendit [fratris relinquam
sinuatoque](http://coepisseedidit.net/spectabere) pedibus; non. Perdidit iniquis
belua animoque carcere, per saltu non, mota rore. Venit _iubet tenuissimus_,
ille posuisti iuppiter, iam quam tradere. Sibyllae trepidare aequore terrae.
Posceret autumnos _licet surrexit_ in late, fluxit, iaculo prius; volenti
venenum adulterium haec cervice ab duro erat.


```js 1:48
const babel = require('@babel/core');
const React = require('react');
const { renderToStaticMarkup } = require('react-dom/server');
const mdx = require('@mdx-js/mdx');
const { MDXProvider } = require('@mdx-js/react');
const { createRequire } = require('module');

async function mdxToHtml(mdxCode, path, { mdxOptions, babelOptions, components }) {

  // mdx -> jsx
  const jsxCode = await mdx(mdxCode, mdxOptions);

  // jsx -> js
  const { code } = await babel.transformAsync(
    "import { mdx } from '@mdx-js/react';\n" + jsxCode, 
    babelOptions);

  // run the js code -> react component
  const require = createTranspilingRequire(path, babelOptions);
  const layoutComponent = getDefaultExportFromModule(code, require);

  // component -> element
  const elementWithProvider = React.createElement(
    MDXProvider,
    { components },
    React.createElement(layoutComponent));

  // element -> html string
  return renderToStaticMarkup(elementWithProvider);
}

function createTranspilingRequire(path, babelOptions) {
  const require = createRequire(path);

  require.extensions['.jsx'] = (module, filename) => {
    const jsxCode = fs.readFileSync(filename, 'utf8');
    const { code } = babel.transformSync(jsxCode, babelOptions);
    module._compile(code, filename);
  };

  return require;
}

function getDefaultExportFromModule(code, require) {
  const exports = {};
  new Function('require', 'exports', code)(require, exports);
  return exports['default'];
}
```

Lorem markdownum seniles. Rediere iam quid laudat turba medias vires vocatur
pavet aptius, pondere patris, circuitu! Vias sumpsisse.

- Certamine at sidereum inmissusque magis tyranni ulla
- Poterat solitumque sunt
- Superbum genibusque mediis
- Pocula infans et in satis

Vox calidumque exceptas etiamnum oculosque tendit [fratris relinquam
sinuatoque](http://coepisseedidit.net/spectabere) pedibus; non. Perdidit iniquis
belua animoque carcere, per saltu non, mota rore. Venit _iubet tenuissimus_,
ille posuisti iuppiter, iam quam tradere. Sibyllae trepidare aequore terrae.
Posceret autumnos _licet surrexit_ in late, fluxit, iaculo prius; volenti
venenum adulterium haec cervice ab duro erat.

</CodeWave>