
  
  <!DOCTYPE html>
  <html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marius Gundersen</title>
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="viewport" content="width=700px, initial-scale=0.5" />
    <link rel="stylesheet" href="/style/main.css?v=1631101803805" />
    <link rel="stylesheet" href="/style/tomorrow-night.css?v=1631101803805" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.10/dist/katex.min.css" integrity="sha384-0cCFrwW/0bAk1Z/6IMgIyNU3kfTcNirlObr4WjrUU7+hZeD6ravdYJ3kPWSeC31M" crossorigin="anonymous">
  </head>

  <body>
    <div id="wrapper">

      <header>
        <h1><a href="/">Marius Gundersen</a></h1>
      </header>
      <nav class="clearfix article">
        <a href="/">
          <span>Work in progress</span>
        </a>
        <a href="/talks">
          <span>Talks</span>

        </a>
      </nav>

      
      <section class="articleBlock">
      <h1>Dynamic endpoint routing in asp.net</h1><p>I want to share a bit about how the endpoint routing in asp.net can be made dynamic. I tried to look into this, but couldn&#x27;t find any documentation and so decided that I had to write about it myself. I will use asp.net 6 in this article since I can then use the <a href="https://www.hanselman.com/blog/exploring-a-minimal-web-api-with-aspnet-core-6">minimal apis</a> and more easily fit everything into a single file, but the code shown here will work in asp.net 5 and will work with the classical <code>Startup</code> class too.</p><p>With a minimal api we have a <code>program.cs</code> file that looks like this:</p><pre class="language-csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">MapGet</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>This very simple example adds a single route that responds <code>Hello World!</code> to <code>GET /</code> requests, and we can add more such routes by copying and slightly changing the <code>app.MapGet()</code> line. But we are limited in that we can only statically add routes, we can&#x27;t change routes at runtime. How would we add, remove or change a route while the application is running, without having to restart it?</p><p>The short answer is to use an <code>EndpointDataSource</code>. The slightly longer answer is that everything is already using <code>EndpointDataSource</code>, it&#x27;s just hidden inside extension methods. The <code>app</code> variable is a class that implements <a href="https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/IEndpointRouteBuilder.cs"><code>IEndpointRouteBuilder</code> interface</a> which looks like this:</p><pre class="language-csharp"><code class="language-csharp"><span class="token comment">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="token comment">// The .NET Foundation licenses this file to you under the MIT license.</span>

<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Builder</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Routing</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// Defines a contract for a route builder in an application. A route builder specifies the routes for</span>
    <span class="token doc-comment comment">/// an application.</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IEndpointRouteBuilder</span>
    <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// Creates a new <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IApplicationBuilder<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>.</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>returns</span><span class="token punctuation">&gt;</span></span>The new <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IApplicationBuilder<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>returns</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token return-type class-name">IApplicationBuilder</span> <span class="token function">CreateApplicationBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// Gets the sets the <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IServiceProvider<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> used to resolve services for routes.</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token return-type class-name">IServiceProvider</span> ServiceProvider <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// Gets the endpoint data sources configured in the builder.</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token return-type class-name">ICollection<span class="token punctuation">&lt;</span>EndpointDataSource<span class="token punctuation">&gt;</span></span> DataSources <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>That&#x27;s the whole interface, all the fun methods like <code>MapGet()</code> and <code>MapControllers()</code> are extension methods that can only work with these three exposed members. There&#x27;s no list of endpoints here that the <code>MapGet()</code> extension method could add to, so how are new endpoints added? Instead of adding an endpoint directly the extension methods add data sources to the <code>DataSources</code> collection.</p><p>The <code>DataSources</code> is a collection of <a href="https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/EndpointDataSource.cs"><code>EndpointDataSource</code></a> objects. This abstract class is defined below, and here you can see the <code>Endpoints</code> member that exposes a list of endpoints.</p><pre class="language-csharp"><code class="language-csharp"><span class="token comment">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="token comment">// The .NET Foundation licenses this file to you under the MIT license.</span>

<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Primitives</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Routing</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// Provides a collection of <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Endpoint<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> instances.</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">EndpointDataSource</span>
    <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// Gets a <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IChangeToken<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> used to signal invalidation of cached <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Endpoint<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span></span>
        <span class="token doc-comment comment">/// instances.</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>returns</span><span class="token punctuation">&gt;</span></span>The <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IChangeToken<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>returns</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token return-type class-name">IChangeToken</span> <span class="token function">GetChangeToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// Returns a read-only collection of <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>see</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Endpoint<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> instances.</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token return-type class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span> Endpoints <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>So instead of adding endpoints (aka routes) to <code>app</code> directly, we instead specify a list of endpoint sources, each of which specifies a list of endpoints. But as you can see from the abstract class above, there is also a <code>GetChangeToken()</code> method, which sounds interesting. Maybe we can change what endpoints are registered by playing around with this token?</p><div class="waves-wave"><div class="waves-sticker-container"><div style="height:100%;width:100%"><div class="waves-sticker"><style data-emotion-css="1d4s020">body{color:var(--theme-ui-colors-text,rgb(57,58,52));background-color:var(--theme-ui-colors-background,rgb(246,248,250));}</style><style data-emotion-css="0"></style><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">var</span><span class="token-plain"> builder </span><span class="token-operator">=</span><span class="token-plain"> WebApplication</span><span class="token-punctuation">.</span><span class="token-function">CreateBuilder</span><span class="token-punctuation">(</span><span class="token-plain">args</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-keyword">var</span><span class="token-plain"> app </span><span class="token-operator">=</span><span class="token-plain"> builder</span><span class="token-punctuation">.</span><span class="token-function">Build</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">app</span><span class="token-punctuation">.</span><span class="token-function">MapGet</span><span class="token-punctuation">(</span><span class="token-string">&quot;/&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;Hello World!&quot;</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-plain">app</span><span class="token-punctuation">.</span><span class="token-function">Run</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-36"><span class="token-plain">            </span><span class="token-keyword">throw</span><span class="token-plain"> </span><span class="token-keyword">new</span><span class="token-plain"> </span><span class="token-constructor-invocation">Exception</span><span class="token-punctuation">(</span><span class="token-string">&quot;Did you forget to add MyEndpointDataSource to the services?&quot;</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-36"><span class="token-plain">            </span><span class="token-keyword">throw</span><span class="token-plain"> </span><span class="token-keyword">new</span><span class="token-plain"> </span><span class="token-constructor-invocation">Exception</span><span class="token-punctuation">(</span><span class="token-string">&quot;Did you forget to add MyEndpointDataSource to the services?&quot;</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-36"><span class="token-plain">            </span><span class="token-keyword">throw</span><span class="token-plain"> </span><span class="token-keyword">new</span><span class="token-plain"> </span><span class="token-constructor-invocation">Exception</span><span class="token-punctuation">(</span><span class="token-string">&quot;Did you forget to add MyEndpointDataSource to the services?&quot;</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-95"><span class="token-plain">    </span><span class="token-keyword">private</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-return-type">Endpoint</span><span class="token-plain"> </span><span class="token-function">CreateEndpoint</span><span class="token-punctuation">(</span><span class="token-keyword">string</span><span class="token-plain"> pattern</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">RequestDelegate</span><span class="token-plain"> requestDelegate</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span></div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-102"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IReadOnlyList</span><span class="token-punctuation">&lt;</span><span class="token-return-type">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-plain"> Endpoints </span><span class="token-punctuation">{</span><span class="token-plain"> </span><span class="token-keyword">get</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-punctuation">}</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">.</span><span class="token-function">Empty</span><span class="token-punctuation">&lt;</span><span class="token-generic">Endpoint</span><span class="token-punctuation">&gt;</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-95"><span class="token-plain">    </span><span class="token-keyword">private</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-return-type">Endpoint</span><span class="token-plain"> </span><span class="token-function">CreateEndpoint</span><span class="token-punctuation">(</span><span class="token-keyword">string</span><span class="token-plain"> pattern</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">RequestDelegate</span><span class="token-plain"> requestDelegate</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-64"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IChangeToken</span><span class="token-plain"> </span><span class="token-function">GetChangeToken</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-keyword">new</span><span class="token-plain"> </span><span class="token-constructor-invocation">CancellationChangeToken</span><span class="token-punctuation">(</span><span class="token-plain">_cancellationTokenSource</span><span class="token-punctuation">.</span><span class="token-plain">Token</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-95"><span class="token-plain">    </span><span class="token-keyword">private</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-return-type">Endpoint</span><span class="token-plain"> </span><span class="token-function">CreateEndpoint</span><span class="token-punctuation">(</span><span class="token-keyword">string</span><span class="token-plain"> pattern</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">RequestDelegate</span><span class="token-plain"> requestDelegate</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-64"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IChangeToken</span><span class="token-plain"> </span><span class="token-function">GetChangeToken</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-keyword">new</span><span class="token-plain"> </span><span class="token-constructor-invocation">CancellationChangeToken</span><span class="token-punctuation">(</span><span class="token-plain">_cancellationTokenSource</span><span class="token-punctuation">.</span><span class="token-plain">Token</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-64"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">override</span><span class="token-plain"> </span><span class="token-return-type">IChangeToken</span><span class="token-plain"> </span><span class="token-function">GetChangeToken</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-keyword">new</span><span class="token-plain"> </span><span class="token-constructor-invocation">CancellationChangeToken</span><span class="token-punctuation">(</span><span class="token-plain">_cancellationTokenSource</span><span class="token-punctuation">.</span><span class="token-plain">Token</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-95"><span class="token-plain">    </span><span class="token-keyword">private</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-return-type">Endpoint</span><span class="token-plain"> </span><span class="token-function">CreateEndpoint</span><span class="token-punctuation">(</span><span class="token-keyword">string</span><span class="token-plain"> pattern</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">RequestDelegate</span><span class="token-plain"> requestDelegate</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-95"><span class="token-plain">    </span><span class="token-keyword">private</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-return-type">Endpoint</span><span class="token-plain"> </span><span class="token-function">CreateEndpoint</span><span class="token-punctuation">(</span><span class="token-keyword">string</span><span class="token-plain"> pattern</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">RequestDelegate</span><span class="token-plain"> requestDelegate</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-22"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-keyword">void</span><span class="token-plain"> </span><span class="token-function">AddMyEndpoints</span><span class="token-punctuation">(</span><span class="token-keyword">this</span><span class="token-plain"> </span><span class="token-class-name">IServiceCollection</span><span class="token-plain"> services</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">IConfiguration</span><span class="token-plain"> configuration</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-95"><span class="token-plain">    </span><span class="token-keyword">private</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-return-type">Endpoint</span><span class="token-plain"> </span><span class="token-function">CreateEndpoint</span><span class="token-punctuation">(</span><span class="token-keyword">string</span><span class="token-plain"> pattern</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">RequestDelegate</span><span class="token-plain"> requestDelegate</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-22"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-keyword">void</span><span class="token-plain"> </span><span class="token-function">AddMyEndpoints</span><span class="token-punctuation">(</span><span class="token-keyword">this</span><span class="token-plain"> </span><span class="token-class-name">IServiceCollection</span><span class="token-plain"> services</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">IConfiguration</span><span class="token-plain"> configuration</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.4"><div style="display:inline-block" class="cs-line cs-line-22"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-keyword">void</span><span class="token-plain"> </span><span class="token-function">AddMyEndpoints</span><span class="token-punctuation">(</span><span class="token-keyword">this</span><span class="token-plain"> </span><span class="token-class-name">IServiceCollection</span><span class="token-plain"> services</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">IConfiguration</span><span class="token-plain"> configuration</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="w5n1f6">.css-w5n1f6{color:#d4d4d4;background-color:#1e1e1e;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-cdata,.css-w5n1f6 .token-doctype{font-style:italic;}.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-changed,.css-w5n1f6 .token-keyword,.css-w5n1f6 .token-punctuation,.css-w5n1f6 .token-operator,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-deleted,.css-w5n1f6 .token-string,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-char,.css-w5n1f6 .token-number,.css-w5n1f6 .token-inserted{color:rgb(0,164,219);}.css-w5n1f6 .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-w5n1f6 .token-comment,.css-w5n1f6 .token-prolog,.css-w5n1f6 .token-doctype,.css-w5n1f6 .token-cdata{color:#6a9955;}.css-w5n1f6 .token-punctuation{color:#d4d4d4;}.css-w5n1f6 .token-property,.css-w5n1f6 .token-tag,.css-w5n1f6 .token-boolean,.css-w5n1f6 .token-number,.css-w5n1f6 .token-constant,.css-w5n1f6 .token-symbol,.css-w5n1f6 .token-deleted{color:#b5cea8;}.css-w5n1f6 .token-selector,.css-w5n1f6 .token-attr-name,.css-w5n1f6 .token-string,.css-w5n1f6 .token-char,.css-w5n1f6 .token-builtin,.css-w5n1f6 .token-inserted{color:#ce9178;}.css-w5n1f6 .token-operator,.css-w5n1f6 .token-entity,.css-w5n1f6 .token-url{color:#d4d4d4;background:#1e1e1e;}.css-w5n1f6 .token-atrule,.css-w5n1f6 .token-attr-value,.css-w5n1f6 .token-keyword{color:#c586c0;}.css-w5n1f6 .token-function{color:#dcdcaa;}.css-w5n1f6 .token-regex,.css-w5n1f6 .token-important,.css-w5n1f6 .token-variable{color:#d16969;}.css-w5n1f6 .token-important,.css-w5n1f6 .token-bold{font-weight:bold;}.css-w5n1f6 .token-italic{font-style:italic;}.css-w5n1f6 .token-constant{color:#9CDCFE;}.css-w5n1f6 .token-class-name{color:#4EC9B0;}.css-w5n1f6 .token-parameter{color:#9CDCFE;}.css-w5n1f6 .token-interpolation{color:#9CDCFE;}.css-w5n1f6 .token-punctuation.interpolation-punctuation{color:#569cd6;}.css-w5n1f6 .token-boolean{color:#569cd6;}.css-w5n1f6 .token-property{color:#9cdcfe;}.css-w5n1f6 .token-selector{color:#d7ba7d;}.css-w5n1f6 .token-tag{color:#569cd6;}.css-w5n1f6 .token-attr-name{color:#9cdcfe;}.css-w5n1f6 .token-attr-value{color:#ce9178;}.css-w5n1f6 .token-entity{color:#4ec9b0;cursor:unset;}.css-w5n1f6 .token-namespace{color:#4ec9b0;}</style><pre class="cs-content css-w5n1f6" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="yem7ld-Code">.css-yem7ld-Code{color:#d4d4d4;background-color:#1e1e1e;}</style><code class="cs-scaled-content css-yem7ld-Code" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.4;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-22"><span class="token-plain">    </span><span class="token-keyword">public</span><span class="token-plain"> </span><span class="token-keyword">static</span><span class="token-plain"> </span><span class="token-keyword">void</span><span class="token-plain"> </span><span class="token-function">AddMyEndpoints</span><span class="token-punctuation">(</span><span class="token-keyword">this</span><span class="token-plain"> </span><span class="token-class-name">IServiceCollection</span><span class="token-plain"> services</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-class-name">IConfiguration</span><span class="token-plain"> configuration</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div></div></div></div></div><div class="waves-scroller-container" data-wave-scroller="true"><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:0%;width:3px"></div><div><h2>Registering an EndpointDataSource</h2><p>We&#x27;ll start with the minimal api and then add stuff to it.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>Let&#x27;s make our own <code>EndpointDataSource</code>. This on doesn&#x27;t really do anything, we can make it more useful later on. How would we use this class?</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>This is the simplest way to do it, but that&#x27;s not very pretty. We can hide this detail inside an extension method, just like Microsoft does.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>Very nice, this looks much more professional. We can now hide details of how <code>MyEndpointDataSource</code> is constructed inside this extension method, and all anyone else ever needs to know is that they should call <code>UseMyEndpoints()</code>.</p><p>But now we have a <code>new MyEndpointDataSource()</code> in the extension method, can we improve this? What if we want to inject things into this constructor? To do that we need to get the <code>MyEndpointDataSource</code> from the services list:</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>The extension method now relies on the service provider and dependency injection to create the <code>MyEndpointDataSource</code>. This means that we can inject whatever we want into its constructor, and we don&#x27;t have to change anything here. We&#x27;ll see later how that becomes useful. But, as the exception says, we also have to remember to add <code>MyEndpointDataSource</code> to the list of injectable services.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>By adding it as a singleton before calling <code>builder.Build()</code> we can get the service later by explicitly calling <code>GetService</code> or implicitly through constructor injection. But again, this is exposing some details that aren&#x27;t so nice. We can make another extension method in order to clean up this a bit, making it more like the asp.net routing.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>Moving the <code>AddSingleton</code> call into an extension method hides some details from the developer who is going to maintain our code.</p><p>And there we have it, we have set up our own endpoint data source, just like the routing that is part of asp.net does it. Now we just need to make it do something useful.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><h2>Providing endpoints</h2><p>The endpoints data source we currently have is quite bare, it provides only an empty list of endpoints. Let&#x27;s set it up so that it at least provides one endpoint, although it&#x27;s hardcoded and not terribly interesting.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>The static <code>CreateEndpoint</code> method wraps the <code>RouteEndpointBuilder</code> and the <code>RoutePatternFactory</code> to make an endpoint from a string and a delegate. Making an endpoint is surprisingly difficult, so making your own simplified methods is recommended.</p><p>I use this method to create a single endpoint for the <code>Endpoints</code> list, so you can see how it works. The first parameter is the route pattern, which needs to follow the rules for <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-5.0#route-template-reference">route templates</a>. The second parameter should be a delegate/lambda/method that handles the request.</p><p>You can change the code to add more endpoints if you want to. But all those endpoints will be static, that is, they will be defined before the application starts and cannot be changed. How can we add another endpoint while the application is running?</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>This is a bit of a silly example that lets you change the route using another route. Here you can go to <code>/myEndpoint</code> to get the <code>&quot;Hello World!&quot;</code> response, but if you go to <code>/setEndpoint/yourEndpoint</code>, then <code>/myEndpoint</code> will no longer work, and now you have to go to <code>/yourEndpoint</code>. Well, in theory at least. We need to implement the <code>GetChangeToken</code> for the changes to take place.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>Here we use a <code>CancellationTokenSource</code> to create a <code>CancellationChangeToken</code> (which implements <code>IChangeToken</code>). This is (kind of) the way it&#x27;s done in the <a href="https://github.com/dotnet/aspnetcore/blob/8b30d862de6c9146f466061d51aa3f1414ee2337/src/Mvc/Mvc.Core/src/Routing/ActionEndpointDataSourceBase.cs">asp.net source code</a>, and I haven&#x27;t found a simpler or better way to do it, so I&#x27;ve copied it (with some slight changes) here. It&#x27;s a bit weird to me that we use the concept of cancellation for notifying changes, but if it&#x27;s good enough for Microsoft it&#x27;s good enough for us.</p><p>The change token is used to notify asp.net that the <code>Endpoints</code> list has changed. If you trigger a change through the change token then asp.net will get the (read only) list of endpoints and update the route table. It seems like it also gets a new change token when it gets the list of endpoints, so the change token can only be triggered once. That is why a new one is made each time the <code>Endpoints</code> is written to.</p><p>One thing I haven&#x27;t copied from them (yet) is the locks, which are needed to make it thread-safe. This class is getting a bit too big, having to deal with both the routes and the change notification code, and making it thread-safe will make it even bigger. What we can do is take all the change tracking code and put it in an abstract base class that <code>MyEndpointDataSource</code> can extend.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>Ok, that&#x27;s a lot of code for the <code>MutableEndpointDataSource</code>, but it&#x27;s going to make <code>MyEndpointDataSource</code> much simpler. This abstract class keeps track of endpoints and uses the <code>CancellationTokenSource</code> trick for notifying whenever the list of endpoints change. The only way to change that list is to call <code>SetEndpoints</code> with a new list of endpoints. That method is wrapped in a lock, so that only one thread can make a change to the list at a time. If multiple threads try to call <code>SetEndpoints</code> at the same time they will have to wait and run one at a time.</p><p>How would we use this abstract class?</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p><code>MyEndpointDataSource</code> is now much simpler, it now focuses purely on how to create the endpoints we are interested in. It can call <code>SetEndpoints</code> with the new list of endpoints and let the abstract base class deal with the issue of notifications and stuff.</p><p>And there we have it, probably the simplest way to implement dynamic route updates in asp.net.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><h2>A more realistic usecase</h2><p>When I needed to implement dynamic endpoint routing and went hunting for some documentation, without finding any, it wasn&#x27;t for the use case in the code above. What I needed to support was reading a routing table from the <code>appsettings.json</code> file and reacting to that file changing while the program was running. I&#x27;ll quickly walk you through how I did that, based on the code we have already written.</p><p>Asp.net has support for listening to changes to the settings files and updating the settings while the program is running, so that part was straight forward to do.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>This code assumes our <code>appsettings.json</code> looks something like this:</p><div><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;Logging&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// the usual stuff here</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Routes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;/home&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hello from home&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;/about&quot;</span><span class="token operator">:</span> <span class="token string">&quot;This is the about page&quot;</span>
      <span class="token property">&quot;/some/other/page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;This page has many segments&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>I&#x27;ve created a record called <code>MyConfig</code> that contains a dictionary of routes. I would like to bind this to the <code>appsettings.json</code> file, and that&#x27;s what the <code>Configure&lt;MyConfig&gt;(configuration)</code> call does. I need to pass the configuration into the extension method here, so a small change is needed right at the top of the code too.</p><p>The <code>Configure&lt;MyConfig&gt;(confiuration)</code> line also registers <code>IOptionsMonitor&lt;MyConfig&gt;</code> in the services, so we can inject it into <code>MyEndpointDataSource</code>.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>This simplified example takes the dictionary and maps it so that the key is a route and when you go to it you get the value as a response. For example, you can now request <code>/home</code> and the application will respond with <code>Hello from home</code>.</p><p>There is just one small line of code needed to make it react to <code>appsettings.json</code> changes.</p></div></div><div class="waves-scroller-step"><div class="waves-scroller-progress" style="top:0%;bottom:100%"></div><div><p>Just one little line of code and now the application reacts to changes to the <code>appsettings.json</code> file and updates the routing without having to restart.</p></div></div></div></div><p>The full code can be found below. It should be possible to paste this into a brand new <code>net6.0</code> project and run it.</p><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Routing<span class="token punctuation">.</span>Patterns</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Options</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Primitives</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddMyEndpoints</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">UseMyEndpoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">MapGet</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name">record</span> MyConfig
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IReadOnlyDictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> Routes <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> init<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyExtensionMethods</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddMyEndpoints</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IServiceCollection</span> services<span class="token punctuation">,</span> <span class="token class-name">IConfiguration</span> configuration<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Configure</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyConfig<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>Configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyEndpointDataSource<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UseMyEndpoints</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IEndpointRouteBuilder</span> endpoints<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> dataSource <span class="token operator">=</span> endpoints<span class="token punctuation">.</span>ServiceProvider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyEndpointDataSource<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>dataSource <span class="token keyword">is</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;Did you forget to call Services.AddMyEndpoints()?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        endpoints<span class="token punctuation">.</span>DataSources<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyEndpointDataSource</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MutableEndpointDataSource</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">MyEndpointDataSource</span><span class="token punctuation">(</span><span class="token class-name">IOptionsMonitor<span class="token punctuation">&lt;</span>MyConfig<span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">SetEndpoints</span><span class="token punctuation">(</span><span class="token function">MakeEndpoints</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>CurrentValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">OnChange</span><span class="token punctuation">(</span>config <span class="token operator">=&gt;</span> <span class="token function">SetEndpoints</span><span class="token punctuation">(</span><span class="token function">MakeEndpoints</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span> <span class="token function">MakeEndpoints</span><span class="token punctuation">(</span><span class="token class-name">MyConfig</span> config<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> config<span class="token punctuation">.</span>Routes
            <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>route <span class="token operator">=&gt;</span> <span class="token function">CreateEndpoint</span><span class="token punctuation">(</span>
                route<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
                context <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteAsync</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name">Endpoint</span> <span class="token function">CreateEndpoint</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> pattern<span class="token punctuation">,</span> <span class="token class-name">RequestDelegate</span> requestDelegate<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RouteEndpointBuilder</span><span class="token punctuation">(</span>
            <span class="token named-parameter punctuation">requestDelegate</span><span class="token punctuation">:</span> requestDelegate<span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">routePattern</span><span class="token punctuation">:</span> RoutePatternFactory<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">order</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">MutableEndpointDataSource</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EndpointDataSource</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name"><span class="token keyword">object</span></span> _lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">object</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span> _endpoints<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">CancellationTokenSource</span> _cancellationTokenSource<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">IChangeToken</span> _changeToken<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">MutableEndpointDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Empty</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">MutableEndpointDataSource</span><span class="token punctuation">(</span><span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span> endpoints<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">SetEndpoints</span><span class="token punctuation">(</span>endpoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">IChangeToken</span> <span class="token function">GetChangeToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> _changeToken<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span> Endpoints <span class="token operator">=&gt;</span> _endpoints<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetEndpoints</span><span class="token punctuation">(</span><span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Endpoint<span class="token punctuation">&gt;</span></span> endpoints<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">lock</span> <span class="token punctuation">(</span>_lock<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> oldCancellationTokenSource <span class="token operator">=</span> _cancellationTokenSource<span class="token punctuation">;</span>

            _endpoints <span class="token operator">=</span> endpoints<span class="token punctuation">;</span>

            _cancellationTokenSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CancellationTokenSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _changeToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CancellationChangeToken</span><span class="token punctuation">(</span>_cancellationTokenSource<span class="token punctuation">.</span>Token<span class="token punctuation">)</span><span class="token punctuation">;</span>

            oldCancellationTokenSource<span class="token punctuation">?.</span><span class="token function">Cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>I want to share one extra little thing that I had trouble finding. The code below shows how to make an endpoint that reacts to only POST, unlike the endpoints we have made so far that react to any HTTP method.</p><pre class="language-csharp"><code class="language-csharp">
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name">Endpoint</span> <span class="token function">CreatePostEndpoint</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> pattern<span class="token punctuation">,</span> <span class="token class-name">RequestDelegate</span> requestDelegate<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RouteEndpointBuilder</span><span class="token punctuation">(</span>
            <span class="token named-parameter punctuation">requestDelegate</span><span class="token punctuation">:</span> requestDelegate<span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">routePattern</span><span class="token punctuation">:</span> RoutePatternFactory<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">order</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Metadata <span class="token operator">=</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpMethodMetadata</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> HttpMethods<span class="token punctuation">.</span>Post <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><hr/>
      </section>

      <div>
        <em>
          Did you find a mistake or have a suggestion for an improvement?
          <a href="https://github.com/mariusGundersen/website/issues/new" target="_blank">Let me know</a>
          or
          <a href="https://github.com/mariusGundersen/website/blob/master/article/dynamic-endpoint-routing/index.md" target="_blank">fork it</a>
          and send me a pull-request.
        </em>
      </div>
  

      <footer>
        <div>
          <div id="contactMe">
            <a href="mailto:me@mariusgundersen.com">Email</a>
            <a href="//twitter.com/gundersenMarius">Twitter</a>
            <a href="//github.com/mariusGundersen/">GitHub</a>
            <a href="https://stackoverflow.com/users/1585/marius">Stack Overflow</a>
          </div>
        </div>

        <script type="text/javascript">
          var _paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
            var u="//analytics.mariusgundersen.net/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '1']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
          })();
        </script>
      </footer>
    </div>
  </body>

  </html>

  <script src="./index.js"></script>
  <link rel="stylesheet" href="/style/waves.css?v=1631101803805" />
  <link rel="stylesheet" href="/style/vscode-dark.css?v=1631101803805" />
